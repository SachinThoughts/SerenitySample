SearchExternal_429995_SQL11=select distinct r.encounterid as 'Visit #',i.invoicenumber as 'Invoice #',CONCAT(p.lastname,', ',p.firstname) as Name,p.facilitypatientid as 'MRN',p.sex AS 'Gender',r.PatientType AS 'PT',CONCAT(FORMAT(r.admitdate,'MM/dd/yyyy'),' - ',FORMAT(r.dischargedate,'MM/dd/yyyy')) as 'Service Date',mlps.CurrentPayorPlanCode as PPC,dt.DefectTypeDesc as 'Defect Type',ds.DefectSubCategorydesc as 'Defect Sub-Category' from invoices i inner join registrations r on i.encounterid = r.encounterid inner join persons p on r.personid= p.id inner join coverages c on r.id=c.registrationid inner join MultiLevelPaymentSummary mlps on r.id=mlps.recordkey left join payer.DefectAccount da on r.ID=da.RegistrationID left join accretive_defectsubcategory ds on da.DefectSubCategoryID = ds.DefectSubCategoryID left join accretive_defecttype dt on ds.defecttypeid=dt.defecttypeid where p.lastname like '%s' and p.firstname like '%s'