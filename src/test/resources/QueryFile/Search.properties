SearchExternal_430694_SQL6=select top 1 p.FacilityPatientID, * from persons p inner join Registrations r on p.id=r.personid inner join invoices i on r.id = i.registrationid where i.registrationid >0 order by r.id desc
SearchExternal_430694_SQL12=select distinct r.encounterid as 'Visit #',i.invoicenumber as 'Invoice #',CONCAT(p.lastname,' ',p.firstname) as 'Name',p.facilitypatientid as 'MRN',p.sex AS 'Gender',r.PatientType AS 'PT',CONCAT(FORMAT(r.admitdate,'MM/dd/yyyy'),' - ',FORMAT(r.dischargedate,'MM/dd/yyyy')) as 'Service Date',mlps.CurrentPayorPlanCode as PPC,dt.DefectTypeDesc as 'Defect Type',ds.DefectSubCategorydesc as 'Defect Sub-Category' from invoices i inner join registrations r on i.encounterid = r.encounterid inner join persons p on r.personid= p.id inner join coverages c on r.id=c.registrationid inner join MultiLevelPaymentSummary mlps on r.id=mlps.recordkey left join payer.DefectAccount da on r.ID=da.RegistrationID left join accretive_defectsubcategory ds on da.DefectSubCategoryID = ds.DefectSubCategoryID left join accretive_defecttype dt on ds.defecttypeid=dt.defecttypeid where p.facilitypatientid like '%W7747125%'